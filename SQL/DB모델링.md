# DB 모델링

### 목차
* [Chap01. DB 모델링 개요](#chap01.-db-모델링-개요)
* [Chap02. 개념적 모델링](#chap02.-개념적-모델링)
* [Chap03. 논리적 모델링](#chap03.-논리적-모델링)
* [Chap04. 물리적 모델링](#chap04.-물리적-모델링)
 
## Chap01. DB 모델링 개요

### 소프트웨어 개발과정

* 소프트웨어(프로그램) 개발 프로세스

![소프트웨어개발프로세스](https://github.com/kleg26315/TIL/blob/master/resources/sw%EA%B0%9C%EB%B0%9C%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4.PNG)

![모델링프로세스](https://github.com/kleg26315/TIL/blob/master/resources/%EB%AA%A8%EB%8D%B8%EB%A7%81%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4.PNG)
\
* 데이터 모델링이 논리적 DB 설계로 바뀐 것입니다.

### DB 모델링의 주요 개념

* 엔티티(Entity)

업무의 관심 대상이 되는 정보를 갖고 있거나 그에 대한 정보를 관리할 필요가 있는 유형으로 무형의 사물(개체)등을 말합니다.

오라클의 **테이블**과 같은 것입니다.

* 속성(Attribute)

엔티티에서 관리해야 할 최소 단위 정보 항목(관심이 있는 항목)을 말하며 엔티티는 하나 이상의 속성을 포함합니다.

속성 유형으로 보다 세분화된 개념적 모델링을 위해서 속성의 유형을 다음과 같이 기초속성, 설계속성, 유도속성 3가지로 세분화할 수 있습니다.

|기초 속성<br>(Basic Attribute)|업무로부터 추출된 일반적인 속성<br><br>데이터 요구 분석 명세서에 포함되어 있으며, 현업에서 제공해야 속성이 유지될 수 있습니다.<br><br>예) 상품명, 가격, 주문수량 등|
|:---|:---|
|설계 속성<br>(Designed Attribute)|원래 존재하지는 않지만 **필요에 따라 설계자가 추가**한 속성<br><br>데이터 요구 분석 명세서에 포함되어 있지는 않지만, 설계를 진행하면서 새로 생성됩니다.<br><br>대부분의 코드 속성이나 일련번호처럼 식별자 역할을 하도록 추가된 속성입니다.<br><br>예) 주문번호, 예약번호, 고객번호, 상품코드 등|
|유도 속성<br>(Derived Attribute)|추출 속성이라고도 칭하며, 기본 속성으로부터 **계산 등의 가공처리**를 통해서 생성된 속성<br><br>저장 속성(*Stored Attribute*)의 영향을 받으므로, 저장 속성의 값이 변경되면 함께 변경됩니다.<br><br>저장속성(Stored Attribute): 유도석성을 결정하기 위해 사용되는 속성<br><br>중복의 의미가 있으므로 대게 **개념적 모델링 단계에서 식별하지 않습니다.**<br>(반드시 필요한 경우라면 별도로 정리해서 구현 단계에서 참조합니다.)<br><br>예) 나이(생년월일 속성에서 유도됨), 근무기간(입사일 속성에서 유도됨) 등|

오라클의 **컬럼**과 같은 것입니다.

* 인스턴스(Instance)

엔티티의 속성으로 실제로 구현된 하나의 값을 말합니다.

오라클의 **행**과 같은 것입니다.

* 관계(Relationship)

두 엔티티 사이의 관련성을 나타냅니다.

* 카디널리티(Cardinality)

각 엔티티에 속해 있는 인스턴스들 간에 수적으로 어떤 관계에 있는지를 나타냅니다.

종류로는 1:1, **1:N**, M:N의 관계가 있습니다.

M:N 관계는 관계해소를 통해 각각 1:N 관계로 나뉘어지게 됩니다.

* 주식별자(Primary Identifier)

엔티티 내 각 인스턴스를 구별하는 기준이 되는 속성 (= PK)

* 외래식별자(Foreign Identifier)

관계가 있는 엔티티 간의 연결고리 역할을 하는 속성 (= FK)

* 개념적 설계

요구분석 단계에서 정의된 핵심 개체와 그들 간의 관계를 바탕으로 `ERD`를 생성하는 단계입니다.

* 논리적 설계

개념 설계에서 추상화된 데이터를 구체화하여 개체, 속성을 테이블화하고 상세화 하는 과정입니다.

* 물리적 설계

논리적 설계 단계에서 표현된 데이터(ERD)를 실제 컴퓨터의 저장장치에 어떻게 표현할 것인가<br>
(관계형 데이터베이스로 전환)

## Chap02. 개념적 모델링

### Part 1. Entity 도출하기

* 엔티티 도출

업무 분석 단계 이후, 분석 자료(업무 기술서, 인터뷰 자료, 장부와 전표 등)로부터 엔티티 도출

* 엔티티 도출 과정

정해진 공식은 없으나 경험이 없으면 다음의 과정들을 거쳐서 엔티티 기술서 작성

1. **엔티티 후보 풀**과 **엔티티 리스트**를 그린다.
2. 분석 대상 문서를 보고 **명사를 찾아 표시**한다.
3. 명사 하나하나에 대해 **속성인지 엔티티인지 구분**한다.
4. **중복된 명사나 유사한 의미의 명사는 하나로 정리**한다.
5. **엔티티 후보 풀에 있는 명사들을 검토**한다.
6. 도출된 엔티티에 대하여 구축될 시스템에서 데이터를 **관리할 필요가 있는지 판단**한다.


### Part 2. ER-Diagram

* ERD (Entity-Relationship Diagram)

‘개체 관계도’라고도 불리며 요구분석사항에서 얻은 엔티티와 속성들을 그림으로 그려 관계를 도출한 것입니다.

* 주식별자(Primary Identifier)

\- 엔티티에 소속된 인스턴스들을 구별하는 기준 역할을 하는 속성
\- 주식별자는 **유일성, 최소성, 불변성, 존재성**의 특징을 가짐
\- 주식별자는 하나가 아닌 여러 속성일 수 있음 (복합 키)
\- 엔티티의 속성 중 주식별자 속성이 없다면 새로운 속성을 만들어 줌 (인위적 주식별자)

* 외래 식별자(Foreign Identifier)

\- 관계가 있는 두 엔티티를 부모, 자식 엔티티로 구분한 후 부모의 주식별자와 공통 속성이 자식에게도 존재하면 해당 속성을 외래 식별자로 지정
\- 자식 엔티티에 부모 엔티티 주식별자 공통 속성이 없을 경우 자식에게 속성을 추가한 후 외래 식별자로 지정

* 엔티티 간의 부모-자식 관계

\- 상호 관계가 있는 두 엔티티 중에서 어느 쪽의 정보가 먼저 생성이 되는가에 따라 결정
\- 부모 엔티티의 정보가 있어야지만 존재할 수 있는 것이 자식 엔티티

* 참여도

\- 참여도에는 **필수(mandatory)**, **선택(optional)** 두 가지로 존재
\- 어떤 기준이 되는 엔티티가 있을 때 반드시 대응되는 엔티티가 존재해야 한다면 필수, 존재 할 수도, 하지 않을 수도 있다면 선택

* 카디널리티

\- 두 개의 엔티티 간 관계에서 엔티티에 속해 있는 인스턴스들을 수적으로 표현한 것

* 카디널리티와 참여도에 따른 관계의 종류

![관계의종류](https://github.com/kleg26315/TIL/blob/master/resources/%EA%B4%80%EA%B3%84%EC%9D%98%EC%A2%85%EB%A5%98.PNG)

* 식별 관계(Identifying Relationship)

\- 1:N 관계에서 외래 식별자가 자식 엔티티의 주식별자의 일부가 되는 관계
\- PFK로 표시 **(외래 식별자가 주식별자의 역할도 함)**
\- 실선으로 관계 표시

* 비식별 관계(Non-Identifying Relationship)

\- 1:N 관계에서 외래 식별자가 자식 엔티티의 주식별자 역할을 하지 못하고 단순히 새로운 속성으로 추가되는 관계
\- FK로 표시 **(단지 외래식별자의 역할만 함)**
\- 점선으로 관계 표시

자식 엔티티가 가지고 있는 주식별자가 외래 식별자에 의해서 유일성에 위배되지 않으면 비식별입니다. 

근데 비식별로 뒀을 때 유일성에 위배가 되면 식별로 해야합니다.

* 1 : 1 관계

\- X에 속하는 한 개체는 Y에 속하는 한 개체에만 연결되며,<br>
Y에 속하는 한 개체도 X에 속하는 한 개체에만 연결될 때입니다.

서로서로 한 개체만 연결이 될때는 사실상 합쳐도 무관하지만 개발자의 의도가 있으면 나눠도 상관없습니다.

* 1 : N 관계

\- X에 속하는 한 개체는 Y에 속하는 **여러 개체**에만 연결되며,
Y에 속하는 한 개체는 X에 속하는 **한 개체**와 연결될 때입니다.

제일 많이 존재하는 관계입니다.

* M : N 관계

\- X에 속하는 한 개체는 Y에 속하는 여러 개체와 연결될 수 있으며, Y에 속하는 한 개체도 X
에 속하는 여러 개체와 연결될 수 있을 때

\- M:N 관계는 덜 완성된 모습으로 데이터 구조에 있어서 어떠한 실제적 방법으로도 구현이
불가능하다. (따라서 M:N관계는 해소해 주어야 한다.)

\- 관계해소는 릴레이션엔티티(Relation Entity)를 추가해서 관계를 해소해야합니다.

## Chap03. 논리적 모델링

### 논리적 모델링 단계

개념적 모델링 (ERD) -> 정규화 -> 테이블 상세화

### 정규화

관계형 데이터베이스에서 데이터를 구조화 하는 작업입니다.

* 정규화의 목적

\- 데이터의 중복을 방지하고 보다 효율적으로 데이터를 저장하기 위함
\- 삽입, 삭제, 갱신 이상의 발생 가능성을 줄이기 위함

![정규화](https://github.com/kleg26315/TIL/blob/master/resources/%EC%A0%95%EA%B7%9C%ED%99%94.PNG)

### 이상 (Anomaly)

* 삽입 이상

불필요한 정보를 함께 저장하지 않고는 어떤 정보를 저장하는 것이 불가능

예) 주문에 대한 정보만 입력해도 제품에 대한 정보도 같이 입력해야 함<br>
제품에 대한 정보만 입력하고 싶을 때 주문에 대한 정보는 NULL값을 가짐

* 갱신 이상

반복된 데이터 중에 일부만 수정하면 데이터의 불일치가 발생

예) 동일한 제품명을 중복되어 있는 수만큼 수정 해야 함, 한번만 수정하거나 일부만 수정할 경우 일관성이 맞지 않는 문제 발생

* 삭제 이상

유용한 정보를 함께 삭제하지 않고는 어떤 정보를 삭제하는 것이 불가능

예) 주문에 대한 정보(주문번호, 주문수량)를 삭제할 때 제품번호, 제품명, 단가도 같이 삭제됨

### 정규화 과정

#### 제 1 정규화

엔티티에서 하나의 속성이 복수의 값을 갖도록 설계되었을 때 하나의 속성이 단일 값을 갖도록 하는 것

#### 제 2 정규화

주식별자가 두 개 이상일때, 주식별자가 아닌 속성 중(일반 속성)에서 주식별자 전체가 아닌 일부 속성에 종속된 속성을 찾아 제거하는 것

#### 제 3 정규화

주식별자가 아닌 속성들 중에서 종속 관계에 있는 속성을 찾아 제거하는 것

## Chap04. 물리적 모델링

### 물리적 모델링 개요

물리적 모델링이란 논리적 설계의 산출물인 ERD의 요소들을 관계형 데이터베이스의 요소들로 전환하는 것입니다.

|논리적 DB 설계<br>(데이터 모델링)|물리적 DB 설계|
|:---:|:---:|
|DBMS의 종류/제품에 상관 없이 진행<br>(ERD는 어떤 데이터베이스를 사용해도 적용가능)|특정 DBMS를 전제로 진행<br>(적용 DBMS의 특성을 고려)|

* 물리 모델링 과정

```
사용자 DBMS 결정 -> 데이터 타입/크기 결정 및 업무분석 -> 반정규화
-> 무결성 제약조건 정의 -> 뷰, 인덱스 정의 -> 데이터베이스 생성
```

### 반정규화 (De-Nomalization)

\- 정규화 작업이 완료된 후 데이터 물리 모델링 과정 중 **시스템의 성능 향상, 개발 과정의 편의성, 운영의 단순화**를 추구

\- **중복은 감수**하고 데이터베이스의 성능을 향상시키는 것 (특히 검색 속도)

\- 정규화를 통한 데이터 무결성 유지도 중요하지만, 다수 사용자가 동시 이용하는 환경에서 일정 성능을 유지하는 것도 매우 중요


